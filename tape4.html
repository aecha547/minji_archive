<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>SIDE A: SOIL</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%23050505'/%3E%3Cellipse cx='16' cy='18' rx='6' ry='9' fill='%23558b2f' opacity='.5'/%3E%3C/svg%3E">
<style>
@import url('https://fonts.googleapis.com/css2?family=VT323&family=Caveat:wght@400;600;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap');
:root{
--bg:#030303;--pink:#ff6b9d;--pink-dim:#993d5e;--pink-bright:#ffb3cc;
--gold:#d4af37;--green:#a8e6a3;--warm:#ffeedd;--red:#cc4444;--blue:#5588bb;
--dim:#555;--white:#d4d4d4;--earth:#8B7355;--earth-light:#a89070;--earth-dark:#6a5540;
--font-crt:'VT323',monospace;--font-hand:'Caveat',cursive;--font-serif:'Cormorant Garamond',serif}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}
html,body{height:100%;overflow:hidden;background:#050505;font-family:var(--font-crt);color:var(--pink)}

#vhs-bg{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
#vhs-bg canvas{position:absolute;inset:0;width:100%;height:100%}
.touch-ripple{position:fixed;border-radius:50%;pointer-events:none;z-index:9999;border:2px solid var(--earth);animation:touchRipple .8s ease-out forwards;opacity:0}
@keyframes touchRipple{0%{transform:scale(0);opacity:.7}100%{transform:scale(4);opacity:0}}

.crt-screen{position:relative;overflow:hidden;min-height:100vh}
.crt-screen::before{content:'';position:absolute;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.1) 2px,rgba(0,0,0,.1) 4px);pointer-events:none;z-index:100}
.crt-screen::after{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at center,transparent 50%,rgba(0,0,0,.7) 100%);pointer-events:none;z-index:101}
.scan-bar{position:fixed;top:0;left:0;width:100%;height:6px;background:linear-gradient(180deg,transparent,rgba(255,255,255,.05),transparent);opacity:.4;z-index:102;pointer-events:none;animation:scanbar 5s linear infinite}
@keyframes scanbar{from{top:-4%}to{top:104%}}
.tracking-bar{position:fixed;left:0;width:100%;height:4px;background:linear-gradient(180deg,transparent,rgba(255,255,255,.06),transparent);opacity:0;z-index:103;pointer-events:none}
.tracking-bar.on{opacity:1;animation:trackDrift 3s linear infinite}
@keyframes trackDrift{0%{top:-2%}100%{top:102%}}

#bg-scenes{position:fixed;inset:0;z-index:1;pointer-events:none;opacity:0;transition:opacity 3s}
#bg-scenes.active{opacity:.2}
.bg-scene{position:absolute;inset:0;opacity:0;transition:opacity 3s;overflow:hidden}
.bg-scene.active{opacity:1}
.bg-scene svg{position:absolute;inset:0;width:100%;height:100%}

/* Scene animations â€” kept from original, all work fine */
.scene-seed .soil{animation:soilPulse 10s ease-in-out infinite}
@keyframes soilPulse{0%,100%{opacity:.5}50%{opacity:.7}}
.scene-seed .roots{animation:rootGrow 10s ease-in-out infinite}
@keyframes rootGrow{0%,100%{opacity:.2;transform:scaleY(.6)}50%{opacity:.5;transform:scaleY(1)}}
.scene-seed .main-stem{transform-origin:bottom;animation:stemRise 10s ease-in-out infinite}
@keyframes stemRise{0%,100%{transform:scaleY(.4)}50%{transform:scaleY(1)}}
.scene-seed .stem-segment{animation:stemSway 5s ease-in-out infinite;transform-origin:bottom}
@keyframes stemSway{0%,100%{transform:rotate(-2deg)}50%{transform:rotate(2deg)}}
.scene-seed .leaf{transform-origin:bottom left;animation:leafUnfold 8s ease-in-out infinite}
.scene-seed .leaf:nth-child(2){animation-delay:.8s;transform-origin:bottom right}
@keyframes leafUnfold{0%,100%{transform:rotate(0deg) scale(.4);opacity:.3}50%{transform:rotate(20deg) scale(1);opacity:1}}
.scene-seed .flower-center{animation:flowerPulse 4s ease-in-out infinite}
@keyframes flowerPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}
.scene-seed .petal{transform-origin:center bottom;animation:petalBloom 6s ease-in-out infinite}
.scene-seed .petal:nth-child(2){animation-delay:.2s}
.scene-seed .petal:nth-child(3){animation-delay:.4s}
.scene-seed .petal:nth-child(4){animation-delay:.6s}
.scene-seed .petal:nth-child(5){animation-delay:.8s}
@keyframes petalBloom{0%,100%{transform:scale(.3);opacity:.2}50%{transform:scale(1);opacity:1}}
.scene-seed .glow-aura{animation:glowPulse 6s ease-in-out infinite}
@keyframes glowPulse{0%,100%{opacity:.1;transform:scale(1)}50%{opacity:.25;transform:scale(1.2)}}
.scene-seed .butterfly{animation:butterflyFloat 15s ease-in-out infinite}
@keyframes butterflyFloat{0%,100%{transform:translate(0,0)}25%{transform:translate(40px,-30px)}50%{transform:translate(80px,0)}75%{transform:translate(40px,20px)}}
.scene-seed .butterfly-wing{animation:wingFlutter .15s ease-in-out infinite;transform-origin:center}
@keyframes wingFlutter{0%,100%{transform:scaleX(1)}50%{transform:scaleX(.3)}}
.scene-seed .pollen{animation:pollenFloat 5s ease-in-out infinite}
.scene-seed .pollen:nth-child(2){animation-delay:.7s}
.scene-seed .pollen:nth-child(3){animation-delay:1.4s}
@keyframes pollenFloat{0%,100%{opacity:0;transform:translate(0,0)}50%{opacity:.5;transform:translate(20px,-30px)}}
.scene-seed .water-drop{animation:waterDrop 4s ease-in-out infinite}
.scene-seed .water-drop:nth-child(2){animation-delay:1s}
@keyframes waterDrop{0%{opacity:0;transform:translateY(-20px)}20%{opacity:.6}100%{opacity:0;transform:translateY(100px)}}

/* Loading */
#loading-overlay{position:fixed;inset:0;z-index:9999;background:#000;display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:1;transition:opacity 2s}
#loading-overlay.hidden{opacity:0;pointer-events:none}
.seed-loading{width:100px;height:100px;animation:seedPulse 3s ease-in-out infinite;filter:drop-shadow(0 0 20px rgba(168,230,163,.4))}
@keyframes seedPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
#loading-overlay h1{font-family:var(--font-serif);font-size:clamp(1.5rem,4vw,2.2rem);font-weight:600;color:var(--earth);text-shadow:0 0 30px var(--earth);text-align:center;margin-top:20px}
#loading-overlay .sub{font-family:var(--font-hand);font-size:clamp(.9rem,2vw,1.2rem);color:var(--pink-dim);margin-top:8px;opacity:.7}
.boot-text{color:var(--earth);font-size:13px;margin-top:30px;text-align:left;width:280px;line-height:2;min-height:160px}
.boot-cursor{display:inline-block;width:7px;height:1.1em;background:var(--earth);vertical-align:text-bottom;margin-left:2px;animation:blink .8s step-end infinite}
@keyframes blink{50%{opacity:0}}
@keyframes pulse{0%,100%{opacity:.3}50%{opacity:.7}}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
@keyframes shake{10%,90%{transform:translate(-2px)}20%,80%{transform:translate(2px)}30%,50%,70%{transform:translate(-4px)}40%,60%{transform:translate(4px)}}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
@keyframes screenShake{0%,100%{transform:translate(0)}10%{transform:translate(-2px,1px)}30%{transform:translate(2px,-1px)}50%{transform:translate(-1px,2px)}70%{transform:translate(1px,-1px)}90%{transform:translate(-1px,0)}}

#particles{position:fixed;inset:0;pointer-events:none;z-index:2;overflow:hidden}

.header{position:fixed;top:0;left:0;right:0;z-index:50;display:flex;justify-content:space-between;align-items:center;padding:14px 18px;background:linear-gradient(180deg,rgba(0,0,0,.85),transparent)}
.back-btn{color:var(--dim);text-decoration:none;font-size:.9rem;transition:all .4s}
.back-btn:hover{color:var(--earth);text-shadow:0 0 10px var(--earth)}
.tape-title{background:linear-gradient(180deg,#f0e8d8,#d8d0c0);color:#1a1a1a;padding:4px 12px;font-size:.65rem;text-transform:uppercase;letter-spacing:1px;border:1px solid #888;box-shadow:0 2px 8px rgba(0,0,0,.3)}
.scene-counter{font-size:12px;color:var(--dim);opacity:.6;letter-spacing:1px}

.main{position:relative;z-index:10;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:80px 20px 40px;transition:opacity 1s}
.main.fade-out{opacity:0}

.sheepy-container{display:flex;flex-direction:column;align-items:center;gap:16px;margin-bottom:32px;opacity:0;transform:translateY(-20px);transition:all 1s cubic-bezier(.4,0,.2,1)}
.sheepy-container.show{opacity:1;transform:translateY(0)}
.sheepy-container.hide{opacity:0;transform:translateY(-30px) scale(.95)}
.sheepy-glow{width:clamp(120px,28vw,160px);height:clamp(120px,28vw,160px);background:radial-gradient(circle,rgba(139,115,85,.3) 0%,transparent 70%);border-radius:50%;display:flex;align-items:center;justify-content:center;animation:sheepyGlow 4s ease-in-out infinite}
@keyframes sheepyGlow{0%,100%{transform:scale(1);opacity:.8}50%{transform:scale(1.08);opacity:1}}
.sheepy-text{font-family:var(--font-serif);font-size:clamp(1rem,2.4vw,1.25rem);color:var(--earth);text-align:center;max-width:400px;line-height:2;min-height:3em}
.sheepy-text .hand{font-family:var(--font-hand);font-size:1.2em;color:var(--gold);text-shadow:0 0 10px rgba(212,175,55,.3)}
.sheepy-text .whisper{font-style:italic;opacity:.7;font-size:.9em}

.scene{max-width:520px;width:100%;text-align:center;margin-bottom:28px}
.scene p{font-family:var(--font-serif);font-size:clamp(1rem,2.4vw,1.3rem);line-height:2.2;color:var(--warm);margin-bottom:18px;opacity:0;transform:translateY(12px);transition:all .8s cubic-bezier(.4,0,.2,1)}
.scene p.show{opacity:1;transform:translateY(0)}
.scene p.hide{opacity:0;transform:translateY(-10px)}
.scene .narrator{color:var(--dim);font-style:italic;font-size:.95em}
.scene .her{color:var(--pink);text-shadow:0 0 15px rgba(255,107,157,.2)}
.scene .me{color:var(--gold);text-shadow:0 0 15px rgba(212,175,55,.2)}
.scene .memory{color:var(--earth-light);font-style:italic;font-size:.9em;opacity:.85;border-left:2px solid var(--earth);padding-left:12px;margin-left:auto;margin-right:auto;max-width:400px;text-align:left}
.scene .moment{color:var(--pink-bright);font-weight:600;text-shadow:0 0 20px rgba(255,179,204,.3)}
.scene .time{color:var(--dim);font-size:.85em;font-family:var(--font-crt);letter-spacing:2px}
.scene .phone{color:var(--pink);font-family:var(--font-crt);font-size:.9em;letter-spacing:.5px;opacity:.9}

.choices{width:100%;max-width:460px;display:flex;flex-direction:column;gap:12px;opacity:0;transform:translateY(20px);transition:all 1s .3s}
.choices.show{opacity:1;transform:translateY(0)}
.choice{width:100%;padding:16px 20px;background:linear-gradient(145deg,rgba(20,10,15,.95),rgba(10,5,8,.98));border:1px solid rgba(139,115,85,.25);color:var(--white);font-family:var(--font-serif);font-size:clamp(.95rem,2.1vw,1.15rem);text-align:left;cursor:pointer;transition:all .4s;border-radius:6px;position:relative;overflow:hidden}
.choice::before{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(139,115,85,.08),transparent);transform:translateX(-100%);transition:transform .6s}
.choice:hover:not(:disabled)::before{transform:translateX(100%)}
.choice:hover:not(:disabled){border-color:var(--earth);transform:translateX(6px);box-shadow:0 4px 20px rgba(139,115,85,.15)}
.choice:disabled{cursor:default;opacity:.5}
.choice.selected{border-color:var(--earth);background:linear-gradient(145deg,rgba(139,115,85,.15),rgba(139,115,85,.05));box-shadow:0 0 30px rgba(139,115,85,.2)}
.choice .choice-text{display:block;margin-bottom:6px}
.choice .effect{display:block;font-size:.75rem;color:var(--earth);font-family:var(--font-crt);letter-spacing:1px;margin-top:4px}
.choice .preview{display:block;font-size:.7rem;color:var(--dim);margin-top:4px;font-family:var(--font-hand)}

.match-container{width:100%;max-width:460px;opacity:0;transform:scale(.95);transition:all 1s}
.match-container.show{opacity:1;transform:scale(1)}
.match-header{text-align:center;margin-bottom:16px}
.match-title{font-size:clamp(1rem,2vw,1.2rem);color:var(--earth);letter-spacing:.2em;margin-bottom:6px}
.match-subtitle{font-family:var(--font-hand);font-size:1rem;color:var(--earth-light);opacity:.7}
.match-stakes{display:flex;justify-content:center;gap:30px;margin:12px 0}
.stake{display:flex;flex-direction:column;align-items:center;gap:4px}
.stake-label{font-size:10px;color:var(--dim);letter-spacing:1px}
.stake-value{font-size:18px;color:var(--gold);font-family:var(--font-crt)}
.hearts{display:flex;gap:3px}
.heart{width:12px;height:12px;transition:all .3s}
.heart.active{opacity:1;filter:drop-shadow(0 0 4px var(--pink))}
.heart.lost{opacity:.2}
.match-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.match-card{aspect-ratio:1;background:linear-gradient(145deg,#1a1410,#0d0a08);border:2px solid #2a2015;border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:var(--font-hand);font-size:clamp(.7rem,1.6vw,.9rem);color:var(--dim);cursor:pointer;transition:all .4s;position:relative;overflow:hidden}
.match-card:hover:not(.flipped):not(.matched){border-color:#3a2a1f;transform:scale(1.03)}
.match-card.flipped,.match-card.matched{background:linear-gradient(145deg,#2a1a10,#1a0c08);border-color:var(--earth)}
.match-card.flipped .card-inner,.match-card.matched .card-inner{opacity:1;transform:rotateY(0)}
.card-inner{opacity:0;transform:rotateY(90deg);transition:all .5s;color:var(--earth);text-align:center;padding:6px;line-height:1.4}
.match-card.matched{border-color:var(--green);box-shadow:0 0 15px rgba(168,230,163,.2)}
.match-card.matched .card-inner{color:var(--green)}
.match-card.wrong{animation:shake .3s;border-color:var(--red)}
.match-story{margin-top:20px;text-align:center;min-height:50px;font-family:var(--font-serif);font-size:.95rem;color:var(--gold);font-style:italic;line-height:1.8;opacity:0;transform:translateY(10px);transition:all .6s}
.match-story.show{opacity:1;transform:translateY(0)}

.hud{position:fixed;bottom:16px;right:16px;z-index:50;text-align:right;opacity:0;transform:translateX(20px);transition:all 1s}
.hud.show{opacity:1;transform:translateX(0)}
.hud-title{font-size:10px;color:var(--dim);letter-spacing:2px;margin-bottom:8px}
.meter{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.meter-label{font-size:11px;color:var(--dim);width:50px;text-align:right}
.meter-bar{width:100px;height:6px;background:#1a1a1a;border-radius:3px;overflow:hidden;border:1px solid #2a2a2a}
.meter-fill{height:100%;transition:width .6s;border-radius:2px}
.meter-fill.trust{background:linear-gradient(90deg,var(--earth-dark),var(--earth))}
.meter-fill.guard{background:linear-gradient(90deg,#333,#555)}
.meter-value{font-size:12px;color:var(--earth);min-width:25px}

.hint{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);color:var(--gold);font-size:.85rem;opacity:0;letter-spacing:1px;transition:opacity .5s;animation:hintPulse 2.5s ease-in-out infinite}
.hint.show{opacity:.6}
@keyframes hintPulse{0%,100%{opacity:.3;transform:translateX(-50%) translateY(0)}50%{opacity:.7;transform:translateX(-50%) translateY(-3px)}}

.glitch-overlay{position:fixed;inset:0;z-index:200;pointer-events:none;opacity:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(255,107,157,.08) 2px,rgba(255,107,157,.08) 4px);transition:opacity .2s}
.glitch-overlay.on{opacity:1}
.emotional-pulse{position:fixed;inset:0;z-index:150;pointer-events:none;opacity:0;background:radial-gradient(circle at 50% 50%,rgba(139,115,85,.15) 0%,transparent 50%);transition:opacity 1s}
.emotional-pulse.on{opacity:1;animation:pulseExpand 2s ease-out}
@keyframes pulseExpand{0%{transform:scale(.5);opacity:0}50%{opacity:1}100%{transform:scale(2);opacity:0}}

.audio-btn{position:fixed;top:10px;right:10px;z-index:200;background:rgba(0,0,0,.65);border:1px solid #2a2a2a;border-radius:3px;color:#555;font-family:var(--font-crt);font-size:11px;padding:4px 10px;cursor:pointer;transition:all .3s}
.audio-btn:hover,.audio-btn.on{color:var(--pink);border-color:var(--pink)}
.rating-badge{position:fixed;bottom:16px;left:16px;background:rgba(0,0,0,.6);padding:6px 12px;border-radius:4px;border:1px solid #2a2a2a;font-size:10px;color:var(--earth);z-index:50;opacity:0;transition:opacity 1s}
.rating-badge.show{opacity:.6}

@media(max-width:600px){
.main{padding:70px 16px 30px}
.match-grid{grid-template-columns:repeat(4,1fr);gap:8px}
.match-card{font-size:.65rem}
}
</style>
</head>
<body>

<div id="loading-overlay">
<svg class="seed-loading" viewBox="0 0 100 100"><defs><radialGradient id="sgL" cx="50%" cy="50%"><stop offset="0%" stop-color="#a8e6a3" stop-opacity=".6"/><stop offset="100%" stop-color="#558b2f" stop-opacity=".2"/></radialGradient></defs><ellipse cx="50" cy="50" rx="18" ry="28" fill="url(#sgL)" transform="rotate(-20 50 50)"><animate attributeName="ry" values="28;30;28" dur="2s" repeatCount="indefinite"/></ellipse><path d="M42 22 Q50 10 58 22" stroke="#81c784" stroke-width="2" fill="none"><animate attributeName="d" values="M42 22 Q50 10 58 22;M42 20 Q50 6 58 20;M42 22 Q50 10 58 22" dur="2s" repeatCount="indefinite"/></path></svg>
<h1>SIDE A: SOIL</h1>
<div class="sub">where it all began</div>
<div class="boot-text" id="boot-text"></div>
</div>

<div class="crt-screen">
<div class="scan-bar"></div>
<div class="tracking-bar" id="tracking"></div>
<div id="vhs-bg"><canvas id="vhsCanvas"></canvas></div>

<div id="bg-scenes">
<!-- Single seed scene â€” most thematic for SOIL tape -->
<div class="bg-scene scene-seed active" data-scene="0">
<svg viewBox="0 0 400 300" preserveAspectRatio="xMidYMid slice">
<defs>
<linearGradient id="soilGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#3a2515"/><stop offset="50%" stop-color="#2a1a0a"/><stop offset="100%" stop-color="#1a0a05"/></linearGradient>
<linearGradient id="stemGrad" x1="0%" y1="100%" x2="0%" y2="0%"><stop offset="0%" stop-color="#558b2f" stop-opacity=".6"/><stop offset="100%" stop-color="#a8e6a3" stop-opacity=".5"/></linearGradient>
<radialGradient id="flowerGrad" cx="50%" cy="50%"><stop offset="0%" stop-color="#ffb3cc" stop-opacity=".7"/><stop offset="100%" stop-color="#ff6b9d" stop-opacity=".5"/></radialGradient>
<radialGradient id="glowAura" cx="50%" cy="30%"><stop offset="0%" stop-color="#a8e6a3" stop-opacity=".15"/><stop offset="100%" stop-color="transparent"/></radialGradient>
<linearGradient id="skyS" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#0a0a10"/><stop offset="100%" stop-color="#050508"/></linearGradient>
</defs>
<rect x="0" y="0" width="400" height="180" fill="url(#skyS)"/>
<ellipse class="glow-aura" cx="200" cy="80" rx="100" ry="80" fill="url(#glowAura)"/>
<rect class="soil" x="0" y="200" width="400" height="100" fill="url(#soilGrad)"/>
<g class="roots" transform="translate(200,200)">
<path d="M0 0 Q-20 30 -40 50" stroke="#5a3a20" stroke-width="3" fill="none" opacity=".4"/>
<path d="M0 0 Q15 35 30 60" stroke="#5a3a20" stroke-width="3" fill="none" opacity=".4"/>
<path d="M0 0 Q-5 40 -15 70" stroke="#5a3a20" stroke-width="2" fill="none" opacity=".3"/>
</g>
<g transform="translate(200,200)">
<g class="main-stem">
<g class="stem-segment"><path d="M0 0 Q-5 -30 0 -60" stroke="url(#stemGrad)" stroke-width="6" fill="none"/></g>
<g class="stem-segment" transform="translate(0,-60)"><path d="M0 0 Q5 -30 0 -60" stroke="url(#stemGrad)" stroke-width="5" fill="none"/></g>
</g>
<g transform="translate(0,-40)">
<path class="leaf" d="M0 0 Q-35 -15 -45 10 Q-30 15 0 5 Z" fill="url(#stemGrad)"/>
<path class="leaf" d="M0 0 Q35 -15 45 10 Q30 15 0 5 Z" fill="url(#stemGrad)"/>
</g>
<g transform="translate(0,-80)">
<path class="leaf" d="M0 0 Q-30 -10 -40 8 Q-25 12 0 4 Z" fill="url(#stemGrad)"/>
<path class="leaf" d="M0 0 Q30 -10 40 8 Q25 12 0 4 Z" fill="url(#stemGrad)"/>
</g>
</g>
<g transform="translate(200,75)">
<ellipse class="petal" cx="0" cy="-20" rx="12" ry="22" fill="url(#flowerGrad)"/>
<ellipse class="petal" cx="19" cy="-6" rx="12" ry="22" fill="url(#flowerGrad)" transform="rotate(72)"/>
<ellipse class="petal" cx="12" cy="16" rx="12" ry="22" fill="url(#flowerGrad)" transform="rotate(144)"/>
<ellipse class="petal" cx="-12" cy="16" rx="12" ry="22" fill="url(#flowerGrad)" transform="rotate(216)"/>
<ellipse class="petal" cx="-19" cy="-6" rx="12" ry="22" fill="url(#flowerGrad)" transform="rotate(288)"/>
<circle class="flower-center" cx="0" cy="0" r="10" fill="#d4af37" opacity=".6"/>
</g>
<circle class="pollen" cx="180" cy="60" r="2" fill="#d4af37" opacity=".4"/>
<circle class="pollen" cx="220" cy="50" r="1.5" fill="#d4af37" opacity=".3"/>
<circle class="pollen" cx="200" cy="45" r="2" fill="#d4af37" opacity=".4"/>
<ellipse class="water-drop" cx="150" cy="100" rx="2" ry="4" fill="#5588bb" opacity=".3"/>
<ellipse class="water-drop" cx="250" cy="120" rx="2" ry="4" fill="#5588bb" opacity=".25"/>
<g class="butterfly" transform="translate(80,100)">
<ellipse class="butterfly-wing" cx="-6" cy="0" rx="6" ry="4" fill="#ff6b9d" opacity=".4"/>
<ellipse class="butterfly-wing" cx="6" cy="0" rx="6" ry="4" fill="#ff6b9d" opacity=".4"/>
<ellipse cx="0" cy="0" rx="1.5" ry="4" fill="#993d5e" opacity=".5"/>
</g>
</svg>
</div>
</div>

<div class="glitch-overlay" id="glitch"></div>
<div class="emotional-pulse" id="pulse"></div>
<div id="particles"></div>

<div class="header">
<a href="index.html" class="back-btn">â—€ EJECT</a>
<div class="tape-title">SIDE A: SOIL</div>
<div class="scene-counter" id="counter"></div>
</div>

<button class="audio-btn" id="audio-btn">â™ª OFF</button>

<div class="main" id="main">
<div class="sheepy-container" id="sheepy">
<div class="sheepy-glow" id="sglow"></div>
<div class="sheepy-text" id="stxt"></div>
</div>
<div class="scene" id="scene"></div>
<div class="choices" id="choices"></div>
<div class="match-container" id="match" style="display:none"></div>
</div>

<div class="hud" id="hud">
<div class="hud-title">Emotional State</div>
<div class="meter"><span class="meter-label">TRUST</span><div class="meter-bar"><div class="meter-fill trust" id="tbar" style="width:0%"></div></div><span class="meter-value" id="tval">0</span></div>
<div class="meter"><span class="meter-label">GUARD</span><div class="meter-bar"><div class="meter-fill guard" id="gbar" style="width:0%"></div></div><span class="meter-value" id="gval">0</span></div>
</div>
<div class="hint" id="hint">[ TAP TO CONTINUE ]</div>
<div class="rating-badge" id="rating">RATING: 9.2/10</div>
</div>

<script>
'use strict';
const $=id=>document.getElementById(id);
const sleep=ms=>new Promise(r=>setTimeout(r,ms));

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â˜… INLINE STATE MANAGEMENT â€” No external dependencies
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const EFFECTS={
  e_trust_1:{type:'stat',stat:'trust',delta:1},
  e_trust_2:{type:'stat',stat:'trust',delta:2},
  e_trust_3:{type:'stat',stat:'trust',delta:3},
  e_guard_1:{type:'stat',stat:'guard',delta:1},
  e_guard_2:{type:'stat',stat:'guard',delta:2},
  e_replied_fast:{type:'flag'},e_replied_slow:{type:'flag'},
  e_first_impression_eager:{type:'flag'},e_first_impression_guarded:{type:'flag'},e_first_impression_passive:{type:'flag'},
  e_hesitated:{type:'flag'},e_honesty_moment:{type:'flag'},e_tension_built:{type:'flag'},
  e_caught_smiling:{type:'flag'},e_warmth_shown:{type:'flag'},e_curious:{type:'flag'},
  e_learning_her_language:{type:'flag'},e_sought_connection:{type:'flag'},
  e_time_invested:{type:'flag'},e_shared_laughter:{type:'flag'},e_game_memory:{type:'flag'},
  e_observer_role:{type:'flag'},e_vulnerability_shown:{type:'flag'},e_playful_dynamic:{type:'flag'},
  e_physical_contact:{type:'flag'},e_intimacy_first:{type:'flag'},e_crossed_boundary:{type:'flag'},
  e_distance_kept:{type:'flag'},e_safety_chose:{type:'flag'},e_observer_deepened:{type:'flag'},e_silent_caring:{type:'flag'},
  e_voice_heard_3am:{type:'flag'},e_sunrise_together:{type:'flag'},e_missed_moment:{type:'flag'},
  e_voice_shared:{type:'flag'},e_intimate_medium:{type:'flag'},
  e_territorial:{type:'flag'},e_claimed_space:{type:'flag'},e_jealousy_shown:{type:'flag'},
  e_jealousy_hidden:{type:'flag'},e_sought_place:{type:'flag'},e_different_answer:{type:'flag'},
  e_mask_worn:{type:'flag'},e_feeling_denied:{type:'flag'},
  e_fear_chose:{type:'flag'},e_retreated:{type:'flag'},e_committed:{type:'flag'},e_patience_shown:{type:'flag'},
  e_soil_rich:{type:'arc'},e_soil_rocky:{type:'arc'},e_soil_barren:{type:'arc'},
  e_high_stakes:{type:'flag'},e_full_investment:{type:'flag'},e_cautious_hope:{type:'flag'},
  e_waiting_still:{type:'flag'},e_time_needed:{type:'flag'}
};

const DECISIONS={
  d_tape1_reply_speed:{options:[
    {id:'reply_immediately',effects:['e_trust_1','e_replied_fast','e_first_impression_eager']},
    {id:'wait_hours',effects:['e_guard_1','e_replied_slow','e_first_impression_guarded']},
    {id:'stare_screen',effects:['e_replied_slow','e_first_impression_passive','e_hesitated']}
  ]},
  d_tape1_sigma_reaction:{options:[
    {id:'call_annoying',effects:['e_guard_1','e_honesty_moment','e_tension_built']},
    {id:'say_nothing_smile',effects:['e_trust_1','e_caught_smiling','e_warmth_shown']},
    {id:'ask_meaning',effects:['e_curious','e_learning_her_language','e_sought_connection']}
  ]},
  d_tape1_princess_tycoon:{options:[
    {id:'play_complain',effects:['e_trust_1','e_time_invested','e_shared_laughter','e_game_memory']},
    {id:'refuse_watch',effects:['e_guard_1','e_observer_role','e_game_memory']},
    {id:'make_challenge',effects:['e_trust_1','e_vulnerability_shown','e_playful_dynamic','e_game_memory']}
  ]},
  d_tape1_scratch:{options:[
    {id:'take_hand',effects:['e_trust_2','e_physical_contact','e_intimacy_first','e_crossed_boundary']},
    {id:'look_away',effects:['e_guard_1','e_distance_kept','e_safety_chose']},
    {id:'file_away',effects:['e_observer_deepened','e_silent_caring']}
  ]},
  d_tape1_late_night:{options:[
    {id:'call_now',effects:['e_trust_2','e_vulnerability_shown','e_voice_heard_3am','e_sunrise_together']},
    {id:'text_back_safe',effects:['e_guard_1','e_safety_chose','e_missed_moment']},
    {id:'voice_note',effects:['e_trust_1','e_vulnerability_shown','e_voice_shared','e_intimate_medium']}
  ]},
  d_tape1_jealousy:{options:[
    {id:'tell_her_busy',effects:['e_guard_1','e_territorial','e_claimed_space','e_jealousy_shown']},
    {id:'annoying_how',effects:['e_trust_1','e_sought_place','e_jealousy_shown','e_different_answer']},
    {id:'change_subject',effects:['e_mask_worn','e_jealousy_hidden','e_feeling_denied']}
  ]},
  d_tape1_realization:{options:[
    {id:'pull_back',effects:['e_guard_2','e_fear_chose','e_retreated']},
    {id:'lean_in',effects:['e_trust_2','e_vulnerability_shown','e_committed']},
    {id:'watch_grow',effects:['e_observer_deepened','e_patience_shown']}
  ]},
  d_tape1_soil_choice:{options:[
    {id:'rich_soil',effects:['e_trust_3','e_soil_rich','e_high_stakes','e_full_investment']},
    {id:'rocky_soil',effects:['e_guard_2','e_soil_rocky','e_cautious_hope']},
    {id:'barren_soil',effects:['e_soil_barren','e_waiting_still','e_time_needed']}
  ]}
};

const State={
  trust:0,guard:0,honesty:0,vulnerability:0,
  flags:new Set(),choices:{},
  apply(effectIds){
    const results=[];
    for(const id of effectIds){
      const e=EFFECTS[id];if(!e)continue;
      if(e.type==='stat'){
        this[e.stat]=Math.max(0,Math.min(100,this[e.stat]+e.delta));
        results.push({type:'stat',stat:e.stat,delta:e.delta});
      }else{
        this.flags.add(id);
        results.push({type:e.type,id});
      }
    }
    return results;
  },
  hasFlag(id){return this.flags.has(id)},
  save(){
    try{
      const s=JSON.parse(localStorage.getItem('seed_archive_v3')||'{}');
      s.tape1={complete:true,trust:this.trust,guard:this.guard,
        soil:this.hasFlag('e_soil_rich')?'rich':this.hasFlag('e_soil_rocky')?'rocky':'barren',
        flags:[...this.flags]};
      localStorage.setItem('seed_archive_v3',JSON.stringify(s));
    }catch{}
  },
  updateHUD(){
    $('tbar').style.width=Math.min(this.trust,100)+'%';
    $('gbar').style.width=Math.min(this.guard,100)+'%';
    $('tval').textContent=this.trust;
    $('gval').textContent=this.guard;
  }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUDIO
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const Snd={
  ctx:null,master:null,on:false,
  init(){if(this.ctx)return;this.ctx=new(window.AudioContext||window.webkitAudioContext)();this.master=this.ctx.createGain();this.master.gain.value=0;this.master.connect(this.ctx.destination)},
  resume(){if(this.ctx?.state==='suspended')this.ctx.resume()},
  vol(v){if(!this.master)return;const t=this.ctx.currentTime;this.master.gain.cancelScheduledValues(t);this.master.gain.setValueAtTime(this.master.gain.value,t);this.master.gain.linearRampToValueAtTime(v,t+.4)},
  note(f,dur,type='triangle',vol=.06){if(!this.ctx)return;const o=this.ctx.createOscillator(),g=this.ctx.createGain(),t=this.ctx.currentTime;o.type=type;o.frequency.value=f;g.gain.setValueAtTime(.001,t);g.gain.linearRampToValueAtTime(vol,t+.01);g.gain.exponentialRampToValueAtTime(.001,t+dur);o.connect(g);g.connect(this.master);o.start();o.stop(t+dur+.05)},
  noise(dur,vol=.06){if(!this.ctx)return;const sz=this.ctx.sampleRate*dur|0,buf=this.ctx.createBuffer(1,sz,this.ctx.sampleRate),d=buf.getChannelData(0);for(let i=0;i<sz;i++)d[i]=Math.random()*2-1;const s=this.ctx.createBufferSource(),g=this.ctx.createGain(),t=this.ctx.currentTime;s.buffer=buf;g.gain.setValueAtTime(vol,t);g.gain.exponentialRampToValueAtTime(.001,t+dur);s.connect(g);g.connect(this.master);s.start()},
  type(){this.note(1300+Math.random()*350,.012,'square',.012)},
  select(){this.note(440,.1,'sine',.05);setTimeout(()=>this.note(660,.1,'sine',.04),60)},
  whoosh(){this.noise(.2,.03);this.note(250,.15,'sine',.025)},
  emotional(){this.note(220,.8,'sine',.04);setTimeout(()=>this.note(330,.6,'sine',.03),200);setTimeout(()=>this.note(440,.4,'sine',.02),400)},
  glitch(){this.noise(.08,.06);this.note(100+Math.random()*50,.08,'sawtooth',.04)},
  powerOn(){this.noise(.4,.12);this.note(220,.12,'square',.08);setTimeout(()=>this.note(55,.15,'sawtooth',.06),80)},
  complete(){this.note(392,.4,'sine',.06);setTimeout(()=>this.note(494,.4,'sine',.06),200);setTimeout(()=>this.note(587,.6,'sine',.06),400)},
  flip(){this.note(320,.05,'triangle',.04)},
  wrong(){this.note(150,.15,'sawtooth',.08);this.noise(.1,.04)},
  match(){[392,523,659].forEach((f,i)=>setTimeout(()=>this.note(f,.2,'sine',.04),i*80))},
  ensure(){this.init();this.resume();if(!this.on){this.on=true;this.vol(.35);$('audio-btn').textContent='â™ª ON';$('audio-btn').classList.add('on')}},
  toggle(){this.init();this.resume();this.on=!this.on;this.vol(this.on?.35:0);$('audio-btn').textContent=this.on?'â™ª ON':'â™ª OFF';$('audio-btn').classList.toggle('on',this.on)}
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VHS BACKGROUND
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const VHS={
  canvas:null,ctx:null,w:0,h:0,pts:[],
  init(){
    this.canvas=$('vhsCanvas');this.ctx=this.canvas.getContext('2d');this.resize();
    window.addEventListener('resize',()=>this.resize());
    for(let i=0;i<40;i++)this.pts.push({x:Math.random()*this.w,y:Math.random()*this.h,vx:(Math.random()-.5)*.3,vy:-.2-Math.random()*.4,sz:1+Math.random()*3,op:.02+Math.random()*.08,phase:Math.random()*6.28});
    this.draw();
  },
  resize(){this.w=this.canvas.width=innerWidth;this.h=this.canvas.height=innerHeight},
  draw(){
    const c=this.ctx,w=this.w,h=this.h;if(!w){requestAnimationFrame(()=>this.draw());return}
    c.fillStyle='rgba(5,5,5,.12)';c.fillRect(0,0,w,h);
    for(const p of this.pts){
      p.x+=p.vx+Math.sin(p.phase+=.005)*.3;p.y+=p.vy;
      if(p.y<-10){p.y=h+10;p.x=Math.random()*w}
      if(p.x<-10)p.x=w+10;if(p.x>w+10)p.x=-10;
      c.beginPath();c.arc(p.x,p.y,p.sz,0,6.28);
      c.fillStyle=`rgba(139,115,85,${p.op})`;c.fill();
    }
    if(Math.random()<.02){c.fillStyle='rgba(139,115,85,.015)';c.fillRect(0,Math.random()*h,w,2+Math.random()*6)}
    requestAnimationFrame(()=>this.draw());
  }
};

/* Particles */
const Dust={
  pool:[],anims:[],idx:0,iv:0,
  init(){for(let i=0;i<20;i++){const p=document.createElement('div');p.className='particle';p.style.cssText='opacity:0;width:3px;height:3px';$('particles').appendChild(p);this.pool.push(p);this.anims.push(null)}},
  spawn(){const i=this.idx++%20;if(this.anims[i])this.anims[i].cancel();const p=this.pool[i],sz=2+Math.random()*4,dur=10000+Math.random()*14000,dx=(Math.random()-.5)*80,op=.04+Math.random()*.1;p.style.cssText=`left:${Math.random()*100}%;bottom:-10px;width:${sz}px;height:${sz}px;background:radial-gradient(circle,rgba(139,115,85,.15),transparent);opacity:0`;this.anims[i]=p.animate([{transform:'translateY(0) translateX(0)',opacity:0},{opacity:op,offset:.1},{opacity:op,offset:.9},{transform:`translateY(calc(-100vh - 20px)) translateX(${dx}px)`,opacity:0}],{duration:dur,fill:'forwards'})},
  start(){if(!this.iv)this.iv=setInterval(()=>this.spawn(),1200)},stop(){clearInterval(this.iv);this.iv=0}
};

/* Touch */
document.addEventListener('pointerdown',e=>{const r=document.createElement('div');r.className='touch-ripple';r.style.left=(e.clientX-20)+'px';r.style.top=(e.clientY-20)+'px';r.style.width=r.style.height='40px';document.body.appendChild(r);setTimeout(()=>r.remove(),800)},{passive:true});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHEEPY
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const Sheepy={
  mouths:{nervous:'M-4 4 Q-2 2 0 4 Q2 6 4 4',happy:'M-5 2 Q0 8 5 2',sad:'M-5 5 Q0 0 5 5',thoughtful:'M-3 3 Q0 5 3 3'},
  svg(sz,expr='nervous',hold=false){const m=this.mouths[expr]||this.mouths.nervous;
    return`<svg width="${sz}" height="${sz}" viewBox="0 0 120 120" style="animation:bounce 3s infinite"><ellipse cx="60" cy="75" rx="32" ry="26" fill="#e8e0d8"/><ellipse cx="40" cy="70" rx="11" ry="9" fill="#fafafa"/><ellipse cx="80" cy="70" rx="11" ry="9" fill="#fafafa"/><ellipse cx="60" cy="35" rx="18" ry="14" fill="#ffeef0"/><ellipse cx="35" cy="28" rx="6" ry="4" fill="#d8c8b8" transform="rotate(-18 35 28)"/><ellipse cx="85" cy="28" rx="6" ry="4" fill="#d8c8b8" transform="rotate(18 85 28)"/><ellipse cx="50" cy="33" rx="3.5" ry="4.5" fill="#222"><animate attributeName="ry" values="4.5;4.5;.5;4.5;4.5" keyTimes="0;.45;.5;.55;1" dur="4s" repeatCount="indefinite"/></ellipse><ellipse cx="70" cy="33" rx="3.5" ry="4.5" fill="#222"><animate attributeName="ry" values="4.5;4.5;.5;4.5;4.5" keyTimes="0;.45;.5;.55;1" dur="4s" repeatCount="indefinite"/></ellipse><circle cx="51" cy="31" r="1.2" fill="#fff"/><circle cx="71" cy="31" r="1.2" fill="#fff"/><ellipse cx="60" cy="41" rx="2.5" ry="1.5" fill="#c8a898"/><g transform="translate(60 49)"><path d="${m}" stroke="#c8a898" stroke-width="1.5" fill="none" stroke-linecap="round"/></g>${hold?'<g transform="translate(78 52)"><rect width="18" height="12" rx="1" fill="#fff5e6" stroke="#8B7355"/><circle cx="9" cy="6" r="2" fill="#8B7355"/></g>':''}</svg>`},
  show(expr,hold){$('sglow').innerHTML=this.svg(110,expr,hold)},
  async say(text,spd=22){const el=$('stxt');el.innerHTML='';for(let i=0;i<text.length;i++){if(text[i]==='<'){const j=text.indexOf('>',i);el.innerHTML+=text.substring(i,j+1);i=j}else{el.innerHTML+=text[i];Snd.type()}await sleep(spd)}}
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UI
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const UI={
  scene:$('scene'),choices:$('choices'),match:$('match'),hint:$('hint'),
  clear(){this.scene.innerHTML='';this.choices.innerHTML='';this.choices.classList.remove('show');this.match.style.display='none';this.hint.classList.remove('show')},
  p(html){const el=document.createElement('p');el.innerHTML=html;this.scene.appendChild(el);return el},
  async show(el,dur=400){el.classList.add('show');await sleep(dur)},
  waitClick(){return new Promise(r=>{this.hint.classList.add('show');const h=()=>{this.hint.classList.remove('show');document.removeEventListener('click',h);document.removeEventListener('keydown',kh);r()};const kh=e=>{if(e.key==='Enter'||e.key===' ')h()};document.addEventListener('click',h);document.addEventListener('keydown',kh)})}
};

const VFX={
  glitch(){$('glitch').classList.add('on');Snd.glitch();setTimeout(()=>$('glitch').classList.remove('on'),200)},
  pulse(){$('pulse').classList.add('on');setTimeout(()=>$('pulse').classList.remove('on'),2000)},
  flash(){$('tracking').classList.add('on');setTimeout(()=>$('tracking').classList.remove('on'),800)}
};

const updateCounter=(c,t)=>$('counter').textContent=`${c}/${t}`;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â˜… CHOOSE â€” Fixed Promise bug
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function choose(decisionId,opts){
  return new Promise(resolve=>{
    UI.choices.innerHTML='';
    const decDef=DECISIONS[decisionId];
    for(const opt of opts){
      const btn=document.createElement('button');btn.className='choice';
      btn.innerHTML=`<span class="choice-text">${opt.text}</span>`;
      if(opt.preview)btn.innerHTML+=`<span class="preview">${opt.preview}</span>`;
      btn.onclick=()=>{
        Snd.select();
        document.querySelectorAll('.choice').forEach(b=>b.disabled=true);
        btn.classList.add('selected');
        // Apply effects from decision graph
        const optDef=decDef?.options?.find(o=>o.id===opt.id);
        if(optDef){
          const results=State.apply(optDef.effects);
          State.choices[decisionId]=opt.id;
          State.updateHUD();
          const trustR=results.filter(r=>r.type==='stat'&&r.stat==='trust');
          const guardR=results.filter(r=>r.type==='stat'&&r.stat==='guard');
          if(trustR.length)btn.innerHTML+=`<span class="effect">Trust +${trustR.reduce((s,r)=>s+r.delta,0)}</span>`;
          if(guardR.length)btn.innerHTML+=`<span class="effect">Guard +${guardR.reduce((s,r)=>s+r.delta,0)}</span>`;
        }
        if(opt.emotional)VFX.pulse();
        setTimeout(()=>resolve(opt.id),1600);
      };
      UI.choices.appendChild(btn);
    }
    UI.choices.classList.add('show');
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MEMORY MATCH â€” Fixed: 4-column grid, 8 pairs
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PAIRS=[
  {id:1,a:'finger slip',b:'fate disguised',story:'She\'ll call it an accident for months. You\'ll let her. Both of you know better.'},
  {id:2,a:'"i\'m sigma"',b:'zero apology',story:'Most people apologize for existing. She walked in like she built the room and was charging rent.'},
  {id:3,a:'princess tycoon',b:'two hours gone',story:'Your castle looked like a depressed shoebox. Hers had seventeen turrets. You didn\'t care. You were laughing too hard.'},
  {id:4,a:'the scratch',b:'three seconds',story:'You held her hand for three seconds over a scratch that didn\'t matter. Both of you still think about it.'},
  {id:5,a:'450 â†’ 80',b:'learning patience',story:'You used to text everyone at 450 wpm. For her, you slowed to 80. She never asked you to.'},
  {id:6,a:'3:08 AM',b:'sunrise on the phone',story:'Her voice at 3 AM sounds different. Softer. Like she\'s only that version of herself for you.'},
  {id:7,a:'"he\'s annoying"',b:'your jaw set',story:'She mentioned another guy. Your body reacted before your brain could stop it. That\'s how you knew.'},
  {id:8,a:'"whatever"',b:'screenshot saved',story:'You said you didn\'t care. Then you saved the conversation. The phone remembers what you deny.'},
];
const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.random()*(i+1)|0;[a[i],a[j]]=[a[j],a[i]]}return a};

async function memoryMatch(){
  UI.clear();
  $('match').style.display='block';
  $('match').classList.add('show');
  $('match').innerHTML=`<div class="match-header"><div class="match-title">MEMORY MATCH</div><div class="match-subtitle">Each pair reveals something you buried</div></div><div class="match-stakes"><div class="stake"><span class="stake-label">PAIRS</span><span class="stake-value" id="pc">0/8</span></div><div class="stake"><span class="stake-label">FOCUS</span><div class="hearts" id="hearts">${'<svg class="heart active" viewBox="0 0 12 12" width="12" height="12"><path d="M6 10 Q2 6 6 2 Q10 6 6 10" fill="#ff6b9d"/></svg>'.repeat(3)}</div></div></div><div class="match-grid" id="mgrid"></div><div class="match-story" id="mstory"></div>`;
  const cards=[];PAIRS.forEach(p=>{cards.push({pid:p.id,text:p.a,story:p.story});cards.push({pid:p.id,text:p.b,story:p.story})});
  shuffle(cards);
  const grid=$('mgrid'),story=$('mstory');
  let flipped=[],matched=0,hearts=3,lock=false;
  const uh=()=>{const h=$('hearts').querySelectorAll('.heart');h.forEach((x,i)=>{x.classList.toggle('lost',i>=hearts);x.classList.toggle('active',i<hearts)})};
  cards.forEach(c=>{
    const card=document.createElement('div');card.className='match-card';
    card.innerHTML=`<div class="card-inner">${c.text}</div>`;
    card.onclick=()=>{
      if(lock||card.classList.contains('flipped')||card.classList.contains('matched'))return;
      Snd.flip();card.classList.add('flipped');flipped.push({card,pid:c.pid});
      if(flipped.length===2){lock=true;
        if(flipped[0].pid===flipped[1].pid){
          Snd.match();matched++;
          const p=PAIRS.find(x=>x.id===flipped[0].pid);
          if(p){story.textContent=p.story;story.classList.add('show')}
          $('pc').textContent=`${matched}/8`;
          setTimeout(()=>{flipped.forEach(f=>f.card.classList.add('matched'));flipped=[];lock=false;
            if(matched>=8)setTimeout(()=>{VFX.pulse();Snd.complete()},600);
          },400);
        }else{
          hearts--;uh();Snd.wrong();flipped.forEach(f=>f.card.classList.add('wrong'));
          setTimeout(()=>{flipped.forEach(f=>{f.card.classList.remove('flipped','wrong')});flipped=[];lock=false;
            if(hearts<=0){hearts=3;matched=0;uh();document.querySelectorAll('.match-card').forEach(c=>c.classList.remove('flipped','matched','wrong'));$('pc').textContent='0/8';story.textContent='Focus. These memories matter more than you think.';story.classList.add('show')}
          },700);
        }
      }
    };
    grid.appendChild(card);
  });
  return new Promise(r=>{const iv=setInterval(()=>{if(matched>=8){clearInterval(iv);setTimeout(r,1500)}},200)});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â˜… BOOT SEQUENCE â€” Actually works now
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function typeBootLine(el,text,spd=18){
  for(let i=0;i<text.length;i++){el.textContent+=text[i];await sleep(spd)}
  el.textContent+='\n';
}

async function boot(){
  const bt=$('boot-text');
  await sleep(800);
  await typeBootLine(bt,'> SEED ARCHIVE v2.0',14);
  await sleep(300);
  await typeBootLine(bt,'> LOADING SIDE A: SOIL...',16);
  await sleep(400);
  await typeBootLine(bt,'> 8 DECISIONS FOUND',14);
  await sleep(300);
  await typeBootLine(bt,'> EMOTIONAL PAYLOAD: ARMED',16);
  await sleep(400);
  await typeBootLine(bt,'> SHEEPY PROTOCOL: ACTIVE',14);
  await sleep(300);
  Snd.ensure();Snd.powerOn();
  await typeBootLine(bt,'> READY.',40);
  const cur=document.createElement('span');cur.className='boot-cursor';bt.appendChild(cur);
  await sleep(1200);
  $('loading-overlay').classList.add('hidden');
  await sleep(2000);
  story();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â˜… MAIN STORY â€” Deeply rewritten narrative
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function story(){
  VHS.init();Dust.init();Dust.start();
  $('bg-scenes').classList.add('active');
  $('hud').classList.add('show');
  $('rating').classList.add('show');
  State.updateHUD();
  const T=20;let idx=0;

  // â•â•â• ACT 1: THE ACCIDENT â•â•â•
  idx++;updateCounter(idx,T);VFX.flash();
  $('sheepy').classList.add('show');
  Sheepy.show('nervous',true);
  await Sheepy.say('<span class="hand">baa.</span> Before this starts...',28);
  await sleep(400);
  await Sheepy.say('I need you to understand: he almost didn\'t reply.',22);
  await sleep(350);
  await Sheepy.say('That\'s important. <span class="whisper">The almost is the whole story.</span>',20);
  await sleep(600);
  $('sheepy').classList.add('hide');await sleep(600);$('sheepy').classList.remove('show','hide');

  UI.clear();
  let p;
  p=UI.p('<span class="time">2:47 PM. Tuesday. You\'re doing nothing important.</span>');await UI.show(p,600);
  p=UI.p('<span class="narrator">Your phone buzzes. Unknown number. The message is clearly meant for someone else.</span>');await UI.show(p,550);
  p=UI.p('<span class="phone">omg wait wrong person lmaooo</span>');await UI.show(p,500);
  await sleep(300);
  p=UI.p('<span class="narrator">That should have been the end of it.</span>');await UI.show(p,550);
  p=UI.p('<span class="memory">You will think about this moment for months. The ordinary Tuesday that split your life into before and after.</span>');await UI.show(p,700);
  await UI.waitClick();

  const c1=await choose('d_tape1_reply_speed',[
    {text:'Reply instantly. Something sarcastic.',id:'reply_immediately',preview:'Curiosity dressed as humor',emotional:true},
    {text:'Wait three hours. Craft something casual.',id:'wait_hours',preview:'Protection over connection'},
    {text:'Stare at it. Thumb hovering. Paralyzed.',id:'stare_screen',preview:'Feeling before acting'}
  ]);

  // â•â•â• ACT 2: FIRST CONTACT â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  if(c1==='reply_immediately'){
    p=UI.p('<span class="phone">lol who were you trying to text ğŸ’€</span>');await UI.show(p,500);
    p=UI.p('<span class="narrator">Forty-seven seconds. That\'s how fast you replied to a stranger.</span>');await UI.show(p,550);
    p=UI.p('<span class="me">Later you\'ll tell yourself it was boredom. You weren\'t bored. You were curious. There is a canyon of difference between those two things.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">Curiosity is just hope trying to look casual.</span>');await UI.show(p,700);
  }else if(c1==='wait_hours'){
    p=UI.p('<span class="narrator">Three hours. You draft the reply four times. Delete it twice.</span>');await UI.show(p,550);
    p=UI.p('<span class="phone">happens to the best of us</span>');await UI.show(p,450);
    p=UI.p('<span class="narrator">Six words. Eleven minutes of editing. She\'ll never know.</span>');await UI.show(p,550);
    p=UI.p('<span class="memory">The distance between what you feel and what you show could fill an ocean.</span>');await UI.show(p,700);
  }else{
    p=UI.p('<span class="narrator">Your thumb hovers. The screen dims. You lock it. Unlock it. Lock it.</span>');await UI.show(p,550);
    p=UI.p('<span class="phone">hello?? u there lol</span>');await UI.show(p,450);
    p=UI.p('<span class="me">She texted again. She didn\'t have to. The universe just made the choice for you.</span>');await UI.show(p,550);
    p=UI.p('<span class="memory">Sometimes the most honest thing you can do is freeze. It means something already matters.</span>');await UI.show(p,700);
  }
  await UI.waitClick();

  // â•â•â• ACT 3: SIGMA â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  p=UI.p('<span class="her">"I\'m sigma."</span>');await UI.show(p,600);
  p=UI.p('<span class="narrator">She says this mid-bite of something. Doesn\'t even look up. Like it\'s a weather report.</span>');await UI.show(p,550);
  p=UI.p('<span class="narrator">Most people enter your life apologizing for the space they take up. She walks in like she designed the floor plan.</span>');await UI.show(p,600);
  p=UI.p('<span class="me">It is the most absurd thing anyone has ever said to you with a straight face. Your mouth does something you don\'t authorize.</span>');await UI.show(p,550);
  await UI.waitClick();

  const c2=await choose('d_tape1_sigma_reaction',[
    {text:'"That\'s genuinely the most unhinged thing anyone has said to me."',id:'call_annoying',preview:'Push back. See what happens.'},
    {text:'Say nothing. You\'re fighting your own face.',id:'say_nothing_smile',preview:'Let her in silently',emotional:true},
    {text:'"Explain. Use small words."',id:'ask_meaning',preview:'Genuine curiosity'}
  ]);

  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  if(c2==='call_annoying'){
    p=UI.p('<span class="narrator">She laughs. Not politely. Full volume. Like you just told the funniest joke she\'s heard all year.</span>');await UI.show(p,600);
    p=UI.p('<span class="her">"Good. Annoyed means you\'re paying attention."</span>');await UI.show(p,500);
    p=UI.p('<span class="me">She\'s right. Which annoys you more. Which she also notices.</span>');await UI.show(p,550);
    p=UI.p('<span class="memory">Some people test you by being soft. She tests you by being impossible. You respect impossible.</span>');await UI.show(p,700);
  }else if(c2==='say_nothing_smile'){
    VFX.pulse();
    p=UI.p('<span class="narrator">Your mouth curves. You kill it immediately. Too late.</span>');await UI.show(p,550);
    p=UI.p('<span class="her">"Caught you."</span>');await UI.show(p,400);
    p=UI.p('<span class="narrator">Two words. Said with the confidence of someone who has been watching you closer than you realized.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">The first crack in your wall was just a smile you couldn\'t suppress. That\'s how every fortress falls.</span>');await UI.show(p,700);
  }else{
    p=UI.p('<span class="her">"It means I don\'t need anyone to tell me I\'m worth something. I already know."</span>');await UI.show(p,550);
    p=UI.p('<span class="narrator">She says this without arrogance. Like stating that water is wet.</span>');await UI.show(p,550);
    p=UI.p('<span class="me">You have never met someone this certain of themselves. It terrifies you. It also makes you want to stay.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">Understanding someone is the first form of intimacy. You just took the first step.</span>');await UI.show(p,700);
  }
  await UI.waitClick();

  // â•â•â• ACT 4: PRINCESS TYCOON â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  p=UI.p('<span class="her">"play princess tycoon with me"</span>');await UI.show(p,500);
  p=UI.p('<span class="narrator">Princess. Tycoon. On Roblox. She is dead serious.</span>');await UI.show(p,550);
  p=UI.p('<span class="narrator">You are a person who has opinions about competitive games. Princess Tycoon is not a competitive game. It is a game for eight-year-olds.</span>');await UI.show(p,600);
  p=UI.p('<span class="me">You should say no. Every part of you that has ever been cool says no.</span>');await UI.show(p,500);
  await UI.waitClick();

  const c3=await choose('d_tape1_princess_tycoon',[
    {text:'Play. Complain the entire time. Have the best night of your month.',id:'play_complain',preview:'Show up completely',emotional:true},
    {text:'Refuse. Watch her play. Run commentary like it\'s an esport.',id:'refuse_watch',preview:'Keep your dignity'},
    {text:'"Only if you promise to lose." Make it personal.',id:'make_challenge',preview:'Engage on your terms'}
  ]);

  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  if(c3==='play_complain'){
    p=UI.p('<span class="narrator">Two hours. Your castle looks like a depressed shoebox. Hers has seventeen turrets and a moat.</span>');await UI.show(p,600);
    p=UI.p('<span class="narrator">She laughs so hard at your castle she chokes on water. You pretend to be offended.</span>');await UI.show(p,550);
    p=UI.p('<span class="me">It is objectively the worst game you have ever played. You will play it again tomorrow. And the day after that. And you will never admit why.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">Time is the only currency that can\'t be faked. You just spent two hours of it on turrets you didn\'t want, for a person you didn\'t expect.</span>');await UI.show(p,700);
  }else if(c3==='refuse_watch'){
    p=UI.p('<span class="me">"Your turret placement is objectively wrong."</span>');await UI.show(p,500);
    p=UI.p('<span class="her">"Your FACE is objectively wrong."</span>');await UI.show(p,450);
    p=UI.p('<span class="narrator">You watch for forty minutes. Your commentary makes her laugh harder than the game does. You pretend that doesn\'t matter to you.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">Distance is just another way of being present. She knows you\'re there. That\'s the point.</span>');await UI.show(p,700);
  }else{
    VFX.pulse();
    p=UI.p('<span class="her">"deal"</span>');await UI.show(p,400);
    p=UI.p('<span class="narrator">She wins. She wins by a margin that suggests she has been playing this game since birth.</span>');await UI.show(p,550);
    p=UI.p('<span class="her">"i didn\'t promise to TRY to lose ğŸ˜ˆ"</span>');await UI.show(p,500);
    p=UI.p('<span class="me">You are not angry. You are impressed. And you are in more trouble than you thought.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">Losing to someone and smiling about it is the body\'s way of waving a white flag.</span>');await UI.show(p,700);
  }
  await UI.waitClick();

  // â•â•â• ACT 5: MEMORY MATCH â•â•â•
  idx++;updateCounter(idx,T);
  $('sheepy').classList.add('show');Sheepy.show('thoughtful');
  await Sheepy.say('Pause. Before we go further...',24);await sleep(400);
  await Sheepy.say('Prove you remember what matters.',22);await sleep(400);
  $('sheepy').classList.add('hide');await sleep(600);$('sheepy').classList.remove('show','hide');
  await memoryMatch();

  idx++;updateCounter(idx,T);UI.clear();
  $('sheepy').classList.add('show');Sheepy.show('happy');
  await Sheepy.say('Good. You remember more than you let on.',22);await sleep(500);
  await Sheepy.say('<span class="hand">Now. The hard part.</span>',20);await sleep(600);
  $('sheepy').classList.add('hide');await sleep(600);$('sheepy').classList.remove('show','hide');
  await UI.waitClick();

  // â•â•â• ACT 6: THE SCRATCH â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  p=UI.p('<span class="narrator">Weeks blur. You stop counting the days since you met. It\'s just... continuous now.</span>');await UI.show(p,600);
  p=UI.p('<span class="narrator">Then one day: a scratch on her hand. Small. The kind most people wouldn\'t notice.</span>');await UI.show(p,550);
  p=UI.p('<span class="me">You notice it before she does. You notice everything about her now. You didn\'t ask for this superpower.</span>');await UI.show(p,600);
  await UI.waitClick();

  const c4=await choose('d_tape1_scratch',[
    {text:'"Show me." Take her hand before you can overthink it.',id:'take_hand',preview:'Cross the line',emotional:true},
    {text:'"Be more careful." Look away. Swallow it.',id:'look_away',preview:'Protect the wall'},
    {text:'Say nothing. Add it to the catalog of things you noticed.',id:'file_away',preview:'Silent devotion'}
  ]);

  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  if(c4==='take_hand'){
    VFX.pulse();Snd.emotional();
    p=UI.p('<span class="narrator">You take her hand. Turn it over. The scratch is nothing.</span>');await UI.show(p,600);
    p=UI.p('<span class="narrator">Three seconds. You hold her hand for three seconds examining a wound that doesn\'t exist.</span>');await UI.show(p,600);
    p=UI.p('<span class="narrator">She doesn\'t pull away. She doesn\'t breathe.</span>');await UI.show(p,550);
    p=UI.p('<span class="me">Neither of you mentions this. Ever. Both of you replay it at 2 AM for weeks.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">The first touch is never the dramatic one. It\'s the one disguised as concern. The one you can both pretend was nothing.</span>');await UI.show(p,700);
  }else if(c4==='look_away'){
    p=UI.p('<span class="me">"Be more careful," you say. Casual. Like you say that to everyone.</span>');await UI.show(p,550);
    p=UI.p('<span class="narrator">You don\'t say that to everyone. She knows. You know she knows.</span>');await UI.show(p,550);
    p=UI.p('<span class="memory">Caring out loud and caring in silence hurt different amounts. Silence hurts you. Sound would hurt her. You chose your pain.</span>');await UI.show(p,700);
  }else{
    p=UI.p('<span class="narrator">You file it away. Her scratches. Her laugh pattern. The way she tucks hair behind her left ear when she\'s nervous.</span>');await UI.show(p,600);
    p=UI.p('<span class="me">You\'re building a cathedral of observations about someone who doesn\'t know it exists.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">Observation is devotion\'s quietest dialect.</span>');await UI.show(p,700);
  }
  await UI.waitClick();

  // â•â•â• ACT 7: 3 AM â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  p=UI.p('<span class="time">11:47 PM â†’ 1:23 AM â†’ 3:08 AM</span>');await UI.show(p,600);
  p=UI.p('<span class="narrator">The texts get later. You never initiate. But your phone is always in your hand. She doesn\'t know that. Or maybe she does.</span>');await UI.show(p,600);
  p=UI.p('<span class="phone">can\'t sleep</span>');await UI.show(p,400);
  p=UI.p('<span class="phone">talk to me</span>');await UI.show(p,400);
  await sleep(300);
  p=UI.p('<span class="me">Four words. The most honest sentence she has ever sent you. Because at 3 AM nobody has the energy to lie.</span>');await UI.show(p,650);
  await UI.waitClick();

  const c5=await choose('d_tape1_late_night',[
    {text:'Call her. Right now. Let 3 AM mean something.',id:'call_now',preview:'Choose presence over safety',emotional:true},
    {text:'Text back. Stay in the safe lane.',id:'text_back_safe',preview:'Keep your distance'},
    {text:'Send a voice note. Your real voice at 3 AM.',id:'voice_note',preview:'The middle path'}
  ]);

  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  if(c5==='call_now'){
    VFX.pulse();Snd.emotional();
    p=UI.p('<span class="narrator">You call. She picks up on the first ring. Which means she was holding her phone too.</span>');await UI.show(p,600);
    p=UI.p('<span class="her">"you actually called"</span>');await UI.show(p,450);
    p=UI.p('<span class="me">"You asked me to."</span>');await UI.show(p,450);
    p=UI.p('<span class="narrator">You talk until the light changes. Neither of you says anything important. Everything is important.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">Some nights get written in ink that doesn\'t wash out. This one stained everything.</span>');await UI.show(p,700);
  }else if(c5==='text_back_safe'){
    p=UI.p('<span class="phone">what\'s keeping you up</span>');await UI.show(p,450);
    p=UI.p('<span class="phone">idk just thinking</span>');await UI.show(p,450);
    p=UI.p('<span class="narrator">You want to ask: about what? About who? About us? You type and delete six things.</span>');await UI.show(p,600);
    p=UI.p('<span class="me">You send a meme instead. Safety has a price tag and you just paid it.</span>');await UI.show(p,550);
    p=UI.p('<span class="memory">The distance between what you typed and what you sent could fill a novel.</span>');await UI.show(p,700);
  }else{
    p=UI.p('<span class="narrator">Your voice at 3 AM. Unguarded. The version of you that only exists when the lights are off.</span>');await UI.show(p,600);
    p=UI.p('<span class="me">"I\'m here. What\'s on your mind?"</span>');await UI.show(p,500);
    p=UI.p('<span class="narrator">She sends one back. Five minutes long. You will never tell anyone what she said. Ever.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">A voice at 3 AM is a letter that can\'t be screenshotted. That\'s why it feels safe.</span>');await UI.show(p,700);
  }
  await UI.waitClick();

  // â•â•â• ACT 8: JEALOUSY â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  p=UI.p('<span class="her">"this guy keeps trying to talk to me lol he\'s so annoying"</span>');await UI.show(p,550);
  p=UI.p('<span class="narrator">She says it casually. Dismissively.</span>');await UI.show(p,500);
  p=UI.p('<span class="me">Your jaw sets. Something in your chest tightens. You did not authorize this reaction. Your body doesn\'t care about authorization.</span>');await UI.show(p,600);
  p=UI.p('<span class="memory">Jealousy is just your subconscious filing a police report: something valuable is at risk.</span>');await UI.show(p,700);
  await UI.waitClick();

  const c6=await choose('d_tape1_jealousy',[
    {text:'"Tell him you\'re busy." Let the silence do the talking.',id:'tell_her_busy',preview:'Territorial honesty'},
    {text:'"Annoying like me, or actually annoying?"',id:'annoying_how',preview:'Seek your place',emotional:true},
    {text:'Change the subject. Pretend your blood pressure is normal.',id:'change_subject',preview:'Deny everything'}
  ]);

  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  if(c6==='tell_her_busy'){
    VFX.glitch();
    p=UI.p('<span class="me">"Tell him you\'re busy."</span>');await UI.show(p,500);
    p=UI.p('<span class="narrator">Four words. She hears the fifth one: <em>with me.</em></span>');await UI.show(p,600);
    p=UI.p('<span class="narrator">She doesn\'t mention him again. Neither do you. The territory has been quietly, irrevocably claimed.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">You didn\'t ask her to choose you. You just made sure she knew you were an option.</span>');await UI.show(p,700);
  }else if(c6==='annoying_how'){
    VFX.pulse();
    p=UI.p('<span class="me">"Annoying like me, or actually annoying?"</span>');await UI.show(p,500);
    p=UI.p('<span class="narrator">She laughs. Stops. Something in her face rearranges itself.</span>');await UI.show(p,550);
    p=UI.p('<span class="her">"you\'re not annoying. you\'re... different."</span>');await UI.show(p,500);
    p=UI.p('<span class="me">"Different" is the most dangerous word in her vocabulary. You screenshot the message. Hate yourself for it. Keep the screenshot anyway.</span>');await UI.show(p,650);
    p=UI.p('<span class="memory">"Different" from her means: I have a category for everyone else, and then there\'s you.</span>');await UI.show(p,700);
  }else{
    p=UI.p('<span class="me">"anyway did you see that meme"</span>');await UI.show(p,450);
    p=UI.p('<span class="narrator">Subject changed. Crisis averted. Heart rate: not averted.</span>');await UI.show(p,550);
    p=UI.p('<span class="me">She sees through it. She always sees through it. She doesn\'t call you out. That\'s worse.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">The mask of indifference fits perfectly. That\'s the problem. It shouldn\'t fit this well.</span>');await UI.show(p,700);
  }
  await UI.waitClick();

  // â•â•â• ACT 9: REALIZATION â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  p=UI.p('<span class="narrator">It doesn\'t happen all at once. There\'s no movie moment.</span>');await UI.show(p,600);
  p=UI.p('<span class="narrator">It\'s just that one day you realize you\'ve been checking your phone every four minutes. For weeks.</span>');await UI.show(p,600);
  p=UI.p('<span class="narrator">And the thought of her not texting backâ€”</span>');await UI.show(p,500);
  await sleep(600);
  p=UI.p('<span class="moment">Unthinkable.</span>');await UI.show(p,800);VFX.pulse();Snd.emotional();
  await sleep(500);
  p=UI.p('<span class="me">The seed is already in the ground. You didn\'t plant it. Nobody asked permission. It just... grew.</span>');await UI.show(p,650);
  await UI.waitClick();

  const c7=await choose('d_tape1_realization',[
    {text:'Pull back. Protect what\'s left of your walls.',id:'pull_back',preview:'Fear wins this round'},
    {text:'Lean in. Whatever this is, let it happen.',id:'lean_in',preview:'Choose courage',emotional:true},
    {text:'Do nothing. Watch. Wait. See what grows.',id:'watch_grow',preview:'Patient acceptance'}
  ]);

  // â•â•â• ACT 10: SOIL â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  $('sheepy').classList.add('show');Sheepy.show('thoughtful');
  await Sheepy.say('A seed doesn\'t choose where it falls.',24);await sleep(500);
  await Sheepy.say('But the soil chooses whether to hold it.',22);await sleep(500);
  await Sheepy.say('<span class="hand">What kind of soil are you?</span>',20);await sleep(600);
  $('sheepy').classList.add('hide');await sleep(600);$('sheepy').classList.remove('show','hide');

  const soilChoice=await choose('d_tape1_soil_choice',[
    {text:'Rich soil. "I want this to grow. I\'ll water it myself."',id:'rich_soil',preview:'All in. No safety net.',emotional:true},
    {text:'Rocky soil. "I\'m afraid. But I won\'t stop it."',id:'rocky_soil',preview:'Guarded. But open.'},
    {text:'Frozen ground. "I\'m not ready. Not yet."',id:'barren_soil',preview:'The seed waits.'}
  ]);

  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  if(State.hasFlag('e_soil_rich')){
    VFX.pulse();Snd.emotional();
    p=UI.p('<span class="me">The soil is warm here. Soft enough to hold something fragile.</span>');await UI.show(p,600);
    p=UI.p('<span class="me">You let yourself sink in. Not all the way. But enough to mean it.</span>');await UI.show(p,550);
    p=UI.p('<span class="narrator" style="color:var(--green)">The seed has found good ground.</span>');await UI.show(p,650);
    p=UI.p('<span class="memory">Rich soil doesn\'t promise growth. It just says: whatever you become, I\'m here for it.</span>');await UI.show(p,700);
  }else if(State.hasFlag('e_soil_rocky')){
    p=UI.p('<span class="me">The soil is cold. Hard in places. But between the stones there are gaps.</span>');await UI.show(p,600);
    p=UI.p('<span class="me">Roots might find the spaces. It will be harder. But nothing grown easily survives the winter.</span>');await UI.show(p,600);
    p=UI.p('<span class="narrator" style="color:var(--earth)">The seed will work harder. It might grow stronger for it.</span>');await UI.show(p,650);
    p=UI.p('<span class="memory">The flowers that push through rock are the ones nobody can pick.</span>');await UI.show(p,700);
  }else{
    p=UI.p('<span class="me">The ground is frozen. Nothing moves. But there\'s a crack. There\'s always a crack.</span>');await UI.show(p,600);
    p=UI.p('<span class="narrator" style="color:var(--dim)">Dormancy isn\'t death. Seeds can wait years.</span>');await UI.show(p,600);
    p=UI.p('<span class="memory">The patient seed outlasts the impatient gardener. Time is on its side.</span>');await UI.show(p,700);
  }
  await UI.waitClick();

  // â•â•â• END â•â•â•
  idx++;updateCounter(idx,T);Snd.whoosh();UI.clear();
  $('sheepy').classList.add('show');Sheepy.show('happy');
  await Sheepy.say('SIDE A is done.',24);await sleep(400);
  await Sheepy.say('The seed is in the ground now.',22);await sleep(400);
  await Sheepy.say('What happens next depends on the weather.',20);await sleep(400);
  await Sheepy.say('<span class="hand">And the weather is always changing.</span>',18);
  await sleep(600);

  State.save();
  Snd.complete();VFX.pulse();
  await sleep(1500);
  UI.clear();
  p=UI.p('<span class="narrator" style="text-align:center;font-size:1.2em;color:var(--earth)">END OF SIDE A â€” EJECTING...</span>');
  await UI.show(p,800);
  await sleep(2500);
  window.location.href='index.html';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EVENTS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
$('audio-btn').addEventListener('click',()=>Snd.toggle());
document.addEventListener('contextmenu',e=>e.preventDefault());
boot();
</script>
</body>
</html>
